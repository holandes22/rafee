upstream django {
    server unix://{{ nginx.socket_file }}; # for a file socket
}

server {
    listen  {{ nginx.server.port }};
    listen [::]:{{ nginx.server.port }} ipv6only=on default_server;
    server_name {{ nginx.server.name }};
    charset     utf-8;

    # max upload size
    client_max_body_size 75M;

    # Frontend root folder
    root {{ project.dist_path }};

    # Serve static files, for API docs
    location /static {
        alias {{ project.static_path }}; 
    }

    # Send all API requests to the Django server.
    location /api {
        uwsgi_pass  django;
        include {{ uwsgi.params_file }};
    }

    # Frontend
    location / {
        try_files $uri $uri/ /index.html?/$request_uri;
    }
}
